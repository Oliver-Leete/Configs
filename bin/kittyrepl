#!/bin/bash

WINTITLE=$1

TITLES=$(kitty @ ls | jq ".[].tabs[].windows[].title")

if ! [[ "$TITLES" =~ \"$WINTITLE\" ]]; then
	kitty @ launch --type=window --window-title="$WINTITLE" --keep-focus fish -c "$2"
fi

cat - | pee "ifne -n kitty @ focus-window --match title:$WINTITLE" "kitty @ send-text --match title:$WINTITLE --stdin"
