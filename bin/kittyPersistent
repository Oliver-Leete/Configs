#!/bin/bash

WINTITLE=$1
shift

TITLES=$(kitty @ ls | jq ".[].tabs[].windows[].title")

if ! [[ "$TITLES" =~ \"$WINTITLE\" ]]; then
	kitty @ launch --type=window --window-title="$WINTITLE" --keep-focus fish -c "$1"
fi
shift

if [ "$#" -eq 0 ]; then
	kitty @ focus-window --match title:"$WINTITLE"
else
	kitty @ send-text --match title:"$WINTITLE" "$@"\\r
fi
