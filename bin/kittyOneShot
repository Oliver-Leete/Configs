#!/bin/bash

WINTITLE=$1
shift

TITLES=$(kitty @ ls | jq ".[].tabs[].windows[].title")

# if ! [[ "$TITLES" =~ \"$WINTITLE\" ]]; then
#     kitty @ launch --type=window --window-title="$WINTITLE" --keep-focus
# fi
if [[ "$TITLES" =~ \"$WINTITLE\" ]]; then
	kitty @ close-window --match title:"$WINTITLE"
fi
kitty @ launch --type=window --window-title="$WINTITLE" --keep-focus

ID=$(kitty @ ls | jq ".[].tabs[].windows[] | select(.title==\"$WINTITLE\") | .id")

if [ "$#" -eq 0 ]; then
	kitty @ focus-window --match id:$ID
else
	kitty @ send-text --match id:$ID $@\\r
	# kitty @ send-text --match id:$ID 
fi
