#!/bin/bash

vol () {
    result=$(rofi -matching fuzzy -l 0 -window-title "Volume" -dmenu "Volume")
    /home/oleete/.config/bin/volume set-sink-volume @DEFAULT_SINK@ "$result"%
}

brightness () {
    result=$(rofi -matching fuzzy -l 0 -window-title "Brightness" -dmenu "Brightness")
    /home/oleete/.config/bin/brightness -set "$result"
}

display () {
    displayctl menu
}

network () {
    networkmanager_dmenu
}

power () {
    items="lock logout suspend hibernate shutdown reboot"
    result=$((for item in $items; do echo $item; done) | rofi -matching fuzzy -window-title "Power" -dmenu "Power")

    case ${result:-} in
        lock)       slock               ;;
        logout)     pkill xmonad      ;;
        suspend)    systemctl suspend   ;;
        hibernate)  systemctl hibernate ;;
        shutdown)   systemctl poweroff  ;;
        reboot)     systemctl reboot    ;;
    esac
}

media () {
    items="play pause next previous skip music"
    result=$((for item in $items; do echo $item; done) | rofi -matching fuzzy -window-title "Media" -dmenu "Media")
    case ${result:-} in
        play) playerctl play ;;
        pause) playerctl pause ;;
        next) playerctl next ;;
        previous) playerctl previous ;;
        skip) playerctl next ;;
        music) xmonadctl-exe nsp-musc ;;
    esac
}

utilities () {
    items="colour-picker calculator screenshot screenshot-area screencap screencap-area screenkey system-monitor"
    result=$((for item in $items; do echo $item; done) | rofi -matching fuzzy -window-title "Utilities" -dmenu "Utilities")
    case ${result:-} in
        colour-picker) /home/oleete/.config/bin/colorPicker ;;
        calculator) xmonadctl-exe nsp-calc ;;
        screenshot) /home/oleete/.config/bin/screencapt ;;
        screenshot-area) /home/oleete/.config/bin/screencapt area ;;
        screencap) /home/oleete/.config/bin/screencast ;;
        screencap-area) /home/oleete/.config/bin/screencast area ;;
        screenkey) screenkey ;;
        system-monitor) /home/oleete/.cabal/bin/xmonadctl-exe nsp-sysm ;;
    esac
}

settings () {
    items="sound bluetooth network battery screenkey system-monitor"
    result=$((for item in $items; do echo $item; done) | rofi -matching fuzzy -window-title "Settings" -dmenu "Settings")
    case ${result:-} in
        sound) pavucontrol ;;
        bluetooth) blueberry ;;
        network) nm-connection-editor ;;
        battery) tlp-ui ;;
        screenkey) screenkey --show-settings ;;
        system-monitor) /home/oleete/.cabal/bin/xmonadctl-exe nsp-sysm ;;
    esac
}

layouts () {
    items="mirror mirror_stack centre_main"
    result=$((for item in $items; do echo $item; done) | rofi -matching fuzzy -window-title "Layout" -dmenu "Layout")
    case ${result:-} in 
        mirror) /home/oleete/.cabal/bin/xmonadctl-exe layout-dir ;;
        mirror_stack) /home/oleete/.cabal/bin/xmonadctl-exe layout-stack-dir ;;
        centre_main) /home/oleete/.cabal/bin/xmonadctl-exe layout-style ;;
    esac
}

menu () {
    items="lock play-pause apps utilities commands media display network power settings volume brightness windows sys-mon terminal calculator music discord tasks notes calendar gmail presets layout"
    result=$((for item in $items; do echo $item; done) | rofi -matching fuzzy -window-title "Menu" -dmenu "Menu")
    case ${result:-} in
        lock)       slock           ;;
        play-pause) playerctl play-pause ;;
        apps) rofi -matching fuzzy -show drun -show-icons ;;
        utilities)  utilities       ;;
        commands) rofi -matching fuzzy -show run ;;
        media)      media           ;;
        display)    /home/oleete/.config/bin/displayctl ;;
        network)    network         ;;
        power)      power           ;;
        settings)   settings        ;;
        volume)     vol             ;;
        brightness) brightness      ;;
        windows) rofi -matching fuzzy -show window ;;
        sys-mon) /home/oleete/.cabal/bin/xmonadctl-exe nsp-sysm ;;
        terminal) /home/oleete/.cabal/bin/xmonadctl-exe nsp-cons ;;
        calculator) /home/oleete/.cabal/bin/xmonadctl-exe nsp-calc ;;
        discord) /home/oleete/.cabal/bin/xmonadctl-exe nsp-disc ;;
        music) /home/oleete/.cabal/bin/xmonadctl-exe nsp-musc ;;
        tasks) workLauncher task ;;
        notes) workLauncher note ;;
        gmail) workLauncher gmail ;;
        calendar) workLauncher gcal ;;
        presets) /home/oleete/.config/bin/wsHarpoon preset ;;
        layout) layouts ;;
    esac
}

workLauncher () {
    WS=$(wmctrl -d | grep '*' | cut -c33- | sed 's/ /-/')
    WSS="Wrk Wrk1 Thesis Comments Sim Exp ANSYS" 
    if [[ "$WSS" == *"$WS"* ]]; then
        /home/oleete/.cabal/bin/xmonadctl-exe nsp-$1-wrk
    else
        /home/oleete/.cabal/bin/xmonadctl-exe nsp-$1
    fi
}

main () {
    case ${1:-mainMenu} in
        mainMenu)   menu        ;;
        lock)       slock           ;;
        play-pause) playerctl play-pause ;;
        apps) rofi -matching fuzzy -show drun -show-icons ;;
        utilities)  utilities       ;;
        commands) rofi -matching fuzzy -show run ;;
        media)      media           ;;
        display)    /home/oleete/.config/bin/displayctl      ;;
        network)    network         ;;
        power)      power           ;;
        settings)   settings        ;;
        volume)     vol             ;;
        brightness) brightness      ;;
        windows) rofi -matching fuzzy -show window ;;
        system-monitor) /home/oleete/.cabal/bin/xmonadctl-exe nsp-sysm ;;
    esac
}

main "$@"
