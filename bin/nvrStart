#!/bin/bash

WS=$(wmctrl -d | grep '*' | cut -c33- | sed 's/ /-/')
serverID="nvr-$WS"
winTitle="MainEditor"

TITLES=$(kitty @ ls | jq ".[].tabs[] | select(.is_focused) | .windows[].title")

if ! [[ "$TITLES" == *"$winTitle"* ]]; then
	kitty @ set-window-title $winTitle
else
	ID=$(kitty @ ls | jq ".[].tabs[] | select(.is_focused) | .windows[] | select(.title==\"$winTitle\") | .id")
	kitty @ focus-window --match id:$ID
fi

nvr -s --servername "/tmp/$serverID" $@
