#!/bin/bash

TITLES=$(kitty @ ls | jq ".[] | select(.is_focused) | .tabs[] | select(.is_focused) | .windows[].title")
tabID=$(kitty @ ls | jq ".[] | select(.is_focused) | .tabs[] | select(.is_focused) | .id")

if ! [[ "$TITLES" =~ \"MainEditor\" ]]; then
    kitty @ set-window-title "MainEditor"
else
    ID=$(kitty @ ls | jq ".[] | select(.is_focused) | .tabs[] | select(.is_focused) | .windows[] | select(.title==\"MainEditor\") | .id")
    kitty @ focus-window --match id:$ID
fi
nvr -s --servername /tmp/nvr-server-$tabID $@
